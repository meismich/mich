# FILE:		remote.5.1.conf
# AUTHOR:	Michael Spence
# DATE:		2012-07-20
#

# LOCAL DEFINITIONS
# -- Ports

pts_citrix =		"80 443 1494 2598 2512 2513 8080"

pt_bma_cctv1 =		"50000"
pt_bma_cctv2 =		"50001"


# -- External Aliases
ext_owa_qld =		"203.38.61.193"		# OWA Ext (aka owa.apeagers.com.au)
ext_194 =		"203.38.61.194"		# TEMP ERANET RDP  == TUNE !!!
ext_195 =		"203.38.61.195"		# TEMP ERANET RDP
ext_196 =		"203.38.61.196"		# TABLET CITRIX
ext_197 =		"203.38.61.197"		# REMOTE CITRIX
ext_198 =		"203.38.61.198"		# TEMP CITRIX
ext_ftp_zoos =		"203.38.61.199"		# Carzoos FTP
ext_ftp_qld1 =		"203.38.61.203"		# AP Eagers FTP
ext_ftp_qld2 = 		"203.38.61.204"		# Carzoos FTP
ext_citrix =		"203.38.61.205"		# NFuse Ext (aka citrix.apeagers.com.au)
ext_intranet =		"203.38.61.206"		# Intranet Ext

table <ext_ctxs> const { $ext_196, $ext_197 }

# -- Internal Targets
int_aus_intranet =	"10.1.1.50"		# WWW by <ape_sites> and SSH, WWW, WWWS by inet_butterfly
int_bne_apps =		"10.1.1.93"		# RDP access by apps team
int_bne_issadm =	"10.1.1.92"		# RDP access by services team
int_bne_dax09 =		"10.1.1.22"		# FTP by <ape_sites>
int_bne_iis =		"10.1.1.90"		# FTP by <ape_sites>
int_citrixgabba =	"10.1.1.6"		# CITRIX by APEagers Staff
int_gk =		"10.1.1.18"		# WWWS by APEagers Staff
int_qld_cit1 =		"10.1.1.65"		# CITRIX by APEagers Staff
int_qld_tftp =		"10.1.1.24"		# FTP by <inet_vital>
int_qld_titan =		"10.1.100.21"		# RDP access by <inet_titan>
int_bma_cctv =		"10.32.3.150"		# 6100,WWW by Michael Kennedy
int_tune_ftp =		"10.1.4.11"		# FTP by <inet_tune>

# -- DMZ Targets
b2b_vga_juniper =       "10.40.1.61"		# VPN by <inet_vwaudi>

table <remote_svrs> const { 
			$int_aus_intranet $int_bne_apps $int_bne_issadm $int_bne_dax09 $int_bne_iis \
			$int_citrixgabba $int_gk $int_qld_cit1 $int_qld_tftp $int_qld_titan $int_bma_cctv \
			$int_tune_ftp $b2b_vga_juniper\
			}

# -- Internet Vendor Sources
inet_butterfly = 	"210.15.233.194"	# INTRANET support company
inet_gen_e =		"59.167.181.41"		# VW/AUDI support company
inet_tmca =		"203.53.49.244 203.53.49.245"	# TOYOTA support company
inet_revolution =	"203.36.194.133"	# TOYOTA support company

table <inet_vwaudi> const { 59.154.32.6, 61.88.114.38, 119.225.2.78, 210.48.210.1 }
table <inet_tune> const { $inet_tmca $inet_revolution }
table <inet_vital> const { 203.206.162.162 202.125.173.39 }
table <inet_titan> const { 203.206.169.89 203.217.12.189 203.59.99.218 203.59.134.193 }

# -- Internet APEagers Sites
ape_billbuckles =	"203.43.230.186"
ape_klosters =		"203.38.221.86"
ape_surfers =		"210.56.85.111, 210.56.85.112"
ape_darwin =		"203.43.230.178"
ape_newstead =		"139.130.41.14"
ape_queensland =	"165.228.157.90"
ape_adtrans =		"210.8.187.102"

table <ape_sites> const { 
			$ape_billbuckles, $ape_klosters, $ape_surfers, $ape_darwin, $ape_newstead, \
			$ape_queensland, $ape_adtrans \
			}


# FTP Anchor
nat-anchor "ftp-proxy/*"
rdr-anchor "ftp-proxy/*"
rdr on $int_if proto tcp from any to any port ftp -> 127.0.0.1 port 8021

# -- Terminal Services Gateway
pass in on $if_ext proto tcp from any to ($if_ext:0) port https rdr-to $int_gk port https

# -- FTP services

pass in on $if_ext proto tcp from <ape_sites> to $ext_ftp_qld1 port { ftp 49151:65535 } rdr-to $int_bne_iis
pass in on $if_ext proto tcp from <ape_sites> to $ext_ftp_qld2 port { ftp 49152:65535 } rdr-to $int_bne_dax09
pass in on $if_ext proto tcp from <inet_tune> to $ext_194 port { ftp-data ftp 49152:65535 } rdr-to 10.1.4.11
pass in on $if_ext proto tcp from <inet_vital> to $ext_ftp_zoos port { ftp-data 2024:65535 } rdr-to $int_qld_tftp

# -- Published Intranet
pass in on $if_ext proto tcp from <ape_sites> to $ext_intranet port www rdr-to $int_aus_intranet

# -- BMA Cameras
pass in on $if_ext proto tcp from any to any port $pt_bma_cctv1 rdr-to $int_bma_cctv port 6100
pass in on $if_ext proto tcp from any to any port $pt_bma_cctv2 rdr-to $int_bma_cctv port 80

# -- Citrix
pass in on $if_ext proto tcp from any to <ext_ctxs> port { $pts_citrix } rdr-to $int_qld_cit1
pass in on $if_ext proto tcp from any to $ext_citrix port { $pts_citrix } rdr-to $int_citrixgabba

# -- RDP Direct
pass in on $if_ext proto tcp from <inet_titan> to $ext_194 port 3389 rdr-to $int_qld_titan port 3389
pass in on $if_ext proto tcp from any to $ext_197 port 33890 rdr-to $int_bne_apps port 3389

# -- Other Specific Remote Access
pass in on $if_ext proto tcp from $inet_butterfly to any port { ssh http https } rdr-to $int_aus_intranet
pass in on $if_ext proto tcp from <inet_vital> to $ext_ftp_zoos port 1122 rdr-to $int_qld_tftp port 22
pass in on $if_ext from <inet_vwaudi> to any rdr-to $b2b_vga_juniper

pass out on $if_int to <remote_svrs> nat-to ($if_int:0)

pass in on $if_int to <ape_sites> port 3389
pass out on $if_ext to <ape_sites> port 3389 nat-to ($if_ext:0)

anchor "ftp-proxy/*"

